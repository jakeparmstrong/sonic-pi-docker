# Running Sonic Pi in Docker to render audio files

This branch allows Sonic Pi to run in Docker on Heroku.

```
git clone <this repo>
heroku create # creates a new Heroku app for you
heroku addons:create papertrail # for log capture (optional)
heroku addons:create bucketeer # for S3 bucket (required - easy to alter to use custom S3 bucket though)

heroku container:login
heroku container:push web
heroku open
```

That gives you a website that looks like this:

![](https://dl.dropboxusercontent.com/s/qsofphm7p4sh3y7/Screenshot%202017-12-04%2012.05.06.png?dl=1)

Entering `play 60; sleep 1` and hitting send will (after around 15 seconds) show the following:

![](https://dl.dropboxusercontent.com/s/s2dnhd5fea8vzsh/Screenshot%202017-12-04%2012.04.56.png?dl=1)

This was audio that was generated by the Heroku app and uploaded to an S3 bucket. You can hear it here:

https://bucketeer-1f9bd419-bfce-4f5f-b8ff-e52e09826786.s3.amazonaws.com/f3024b4d5d13f1d8524dd46bb392fea7.wav

## Rationale

With Docker we have a way to run sandboxed
Sonic Pi code on a server for recording Gists, tweets and the like.

Having more attention on Docker also has the nice side effect of offering an
alternative to Linux users


## Goals

- [x] Make beeps using sonic\_pi gem
- [x] Remove the `--privileged` flag so code is truly sandboxed
- [x] Upload generated audio to S3 bucket
- [x] Run on Heroku :metal:
- [ ] Offer permalinks to generated files
- [ ] Upgrade from Sonic Pi 2.10
- [ ] Convert OSC logs to proper text in Heroku logs
- [ ] Don't regenerate files if we have seen a (whitespace normalized) equivalent before
- [ ] Don't use sleep - move to using a single threaded background queue like Sidekiq
- [ ] Store code, author, source etc. in a database
- [ ] Add a nicer frontend to make this a true community resource
- [ ] Make a twitter bot to listen for `#sp140` and reply with rendered audio

## Extension goals

- [ ] Work out streaming audio with IceCast
